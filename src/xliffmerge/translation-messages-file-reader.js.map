{"version":3,"file":"translation-messages-file-reader.js","sourceRoot":"","sources":["../../../../projects/xliffmerge/src/xliffmerge/translation-messages-file-reader.ts"],"names":[],"mappings":";;AAAA;;GAEG;AACH,8EAA8G;AAC9G,mDAA6C;AAC7C,6CAAuC;AAEvC;;GAEG;AACH,MAAa,6BAA6B;IAEtC;;;;;;;OAOG;IACI,MAAM,CAAC,QAAQ,CAAC,UAAkB,EAClB,IAAY,EACZ,QAAgB,EAChB,sBAA+B;QAClD,MAAM,UAAU,GAAG,sBAAS,CAAC,kBAAkB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAChE,MAAM,cAAc,GAAG,6BAA6B,CAAC,iBAAiB,CAAC,sBAAsB,EAAE,QAAQ,CAAC,CAAC;QACzG,OAAO,oDAA8B,CAAC,eAAe,CAAC,UAAU,EAAE,UAAU,CAAC,OAAO,EAAE,IAAI,EAAE,UAAU,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;IACrI,CAAC;IAED;;;;;;OAMG;IACI,MAAM,CAAC,qBAAqB,CAAC,IAAY,EACZ,QAAgB,EAChB,sBAA+B;QAC/D,MAAM,UAAU,GAAG,sBAAS,CAAC,kBAAkB,CAAC,IAAI,EAAE,QAAQ,CAAC,CAAC;QAChE,MAAM,cAAc,GAAG,6BAA6B,CAAC,iBAAiB,CAAC,sBAAsB,EAAE,QAAQ,CAAC,CAAC;QACzG,OAAO,oDAA8B,CAAC,4BAA4B,CAAC,UAAU,CAAC,OAAO,EAAE,IAAI,EAAE,UAAU,CAAC,QAAQ,EAAE,cAAc,CAAC,CAAC;IACtI,CAAC;IAED;;;;;OAKG;IACK,MAAM,CAAC,iBAAiB,CAAC,sBAA8B,EAAE,QAAgB;QAE7E,IAAI,sBAAsB,EAAE;YACxB,MAAM,gBAAgB,GAAG,sBAAS,CAAC,kBAAkB,CAAC,sBAAsB,EAAE,QAAQ,CAAC,CAAC;YACxF,OAAO;gBACH,UAAU,EAAE,gBAAgB,CAAC,OAAO;gBACpC,IAAI,EAAE,sBAAsB;gBAC5B,QAAQ,EAAE,gBAAgB,CAAC,QAAQ;aACtC,CAAC;SACL;aAAM;YACH,OAAO,IAAI,CAAC;SACf;IACL,CAAC;IAED;;;;;;;OAOG;IACI,MAAM,CAAC,IAAI,CAAC,YAAsC,EAAE,cAAwB;QAC/E,oBAAQ,CAAC,cAAc,CAAC,YAAY,CAAC,QAAQ,EAAE,EAAE,YAAY,CAAC,aAAa,CAAC,cAAc,CAAC,EAAE,YAAY,CAAC,QAAQ,EAAE,CAAC,CAAC;IAC1H,CAAC;CACJ;AAjED,sEAiEC","sourcesContent":["/**\n * Created by roobm on 21.03.2017.\n */\nimport {TranslationMessagesFileFactory, ITranslationMessagesFile} from '@ngx-i18nsupport/ngx-i18nsupport-lib';\nimport {FileUtil} from '../common/file-util';\nimport {XmlReader} from './xml-reader';\n\n/**\n * Helper class to read translation files depending on format.\n */\nexport class TranslationMessagesFileReader {\n\n    /**\n     * Read file function, result depends on format, either XliffFile or XmbFile.\n     * @param i18nFormat format\n     * @param path path\n     * @param encoding encoding\n     * @param optionalMasterFilePath optionalMasterFilePath\n     * @return XliffFile\n     */\n    public static fromFile(i18nFormat: string,\n                           path: string,\n                           encoding: string,\n                           optionalMasterFilePath?: string): ITranslationMessagesFile {\n        const xmlContent = XmlReader.readXmlFileContent(path, encoding);\n        const optionalMaster = TranslationMessagesFileReader.masterFileContent(optionalMasterFilePath, encoding);\n        return TranslationMessagesFileFactory.fromFileContent(i18nFormat, xmlContent.content, path, xmlContent.encoding, optionalMaster);\n    }\n\n    /**\n     * Read file function, result depends on format, either XliffFile or XmbFile.\n     * @param path path\n     * @param encoding encoding\n     * @param optionalMasterFilePath optionalMasterFilePath\n     * @return XliffFile\n     */\n    public static fromUnknownFormatFile(path: string,\n                                        encoding: string,\n                                        optionalMasterFilePath?: string): ITranslationMessagesFile {\n        const xmlContent = XmlReader.readXmlFileContent(path, encoding);\n        const optionalMaster = TranslationMessagesFileReader.masterFileContent(optionalMasterFilePath, encoding);\n        return TranslationMessagesFileFactory.fromUnknownFormatFileContent(xmlContent.content, path, xmlContent.encoding, optionalMaster);\n    }\n\n    /**\n     * Read master xmb file\n     * @param optionalMasterFilePath optionalMasterFilePath\n     * @param encoding encoding\n     * @return content and encoding of file\n     */\n    private static masterFileContent(optionalMasterFilePath: string, encoding: string)\n        : {xmlContent: string, path: string, encoding: string} {\n        if (optionalMasterFilePath) {\n            const masterXmlContent = XmlReader.readXmlFileContent(optionalMasterFilePath, encoding);\n            return {\n                xmlContent: masterXmlContent.content,\n                path: optionalMasterFilePath,\n                encoding: masterXmlContent.encoding\n            };\n        } else {\n            return null;\n        }\n    }\n\n    /**\n     * Save edited file.\n     * @param messagesFile messagesFile\n     * @param beautifyOutput Flag whether to use pretty-data to format the output.\n     * XMLSerializer produces some correct but strangely formatted output, which pretty-data can correct.\n     * See issue #64 for details.\n     * Default is false.\n     */\n    public static save(messagesFile: ITranslationMessagesFile, beautifyOutput?: boolean) {\n        FileUtil.replaceContent(messagesFile.filename(), messagesFile.editedContent(beautifyOutput), messagesFile.encoding());\n    }\n}\n\n"]}